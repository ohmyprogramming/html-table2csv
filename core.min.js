function html_table2csv(e=null,l=",",n=null,r=0){function t(e){o&&!r&&(e=n(e));var l=e.innerText.toString(),t=!1;return o&&r&&(l=n(l)),l.includes('"')&&(t=!0,l=l.replace(/"/g,'""')),l.includes(",")&&(t=!0),t&&(l='"'+l+'"'),l}var u=e.querySelector("tbody"),a=e.querySelector("thead"),o=n instanceof Function;if(null==a&&(a=u.querySelector("tr th").parentElement??null),null===a||null===u)return null;var c="";return c+=Object.values(a.querySelectorAll(["th","td"])).map(e=>t(e)).join(l)+"\n",c+=Object.values(u.querySelectorAll("tr")).map(e=>Object.values(e.querySelectorAll("td")).map(e=>t(e)).join(l)+"\n").join("")}